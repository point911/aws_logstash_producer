---

server_group: "{{ lookup('env','LOGSTASH_OUTPUT_KAFKA_SERVERS_GROUP') if lookup('env','LOGSTASH_OUTPUT_KAFKA_SERVERS_GROUP') != '' else 'kafka' }}"

logstash:

  inputs:
    file:
      path: /tmp/output.log

  outputs:
    kafka:
      bootstrap_servers: "{{ groups["security_group_"+server_group]|map('extract', hostvars, 'ec2_private_ip_address')|list|join(':9092,')+':9092' }}"
      topic_id: logstash

  plugins: []

